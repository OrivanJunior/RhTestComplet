uses 
CommonsAll,
ObjCadEventos,
VarConst,
CoommonsObj,
DatapoolEventos;


procedure FiltroTelaInicialEvento();
begin
FiltraCadEvento();
FiltraConsultaEventos.Keys('Código do Evento');
FiltraEventos.SelectItem('(Ignorar)');
BtnOKFiltroEvento.ClickButton;
end;

procedure PreencheInfoNormais(pathData);
Var
DDTInfoNormais : OleVariant;
begin
DDTInfoNormais := CarregaDDT(pathData,'Info Normais');
LeDataPoolInfoNormais(DDTInfoNormais.Name);
MapCadEventos();

VerificaInsere(CadEventosEBIdEventos,CadEventosDPIdEventos);
VerificaInsere(CadEventosEBSequencia,CadEventosDPSequencia);
VerificaInsere(CadEventosEBInativo,CadEventosDPInativo);
VerificaInsere(CadEventosEBSubseq,CadEventosDPSubseq);
PreencheDatas(CadEventosEBDtinativo,CadEventosDPDtinativo);
VerificaInsere(CadEventosEBUserid,CadEventosDPUserid);
VerificaInsere(CadEventosEBDescricao,CadEventosDPDescricao);
VerificaInsere(CadEventosEBCodhomolog,CadEventosDPCodhomolog);
VerificaInsere(CadEventosEBInvisivel,CadEventosDPInvisivel);
VerificaInsere(CadEventosEBOpevento,CadEventosDPOpevento);
VerificaConsultaF3Insere(CadEventosEBIdtipo,CadEventosDPIdtipo);
VerificaConsultaF3Insere(CadEventosEBIdevecalc,CadEventosDPIdevecalc);
end;

procedure PreencheValidaSituacao(pathData);
var
DDTSituacao : OleVariant;
i : integer;
begin
i:= 0;
  CadFormPageValida.ActivePageIndex := 0;
  
  DDTSituacao := CarregaDDT(pathData, 'Situações');
  
  LeDataPoolValidacoes(DDTSituacao.Name);
  
  BtnIncSit.Click();
  
  Log.Checkpoint('Preenchendo Situações');
  
  VerificaClickPreencheGrid(GridSituacao,i, 'Código', ValidaEventosDPCodSit);
  
  GridSituacao.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTSituacao.Name);
end;


procedure PreencheValidaCausas(pathData);
var
DDTCausas : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 1;
  
  DDTCausas := CarregaDDT(pathData, 'Causas');
  
  LeDataPoolValidacoes(DDTSituacao.Name);
  
  BtnIncCau.Click();
  
  Log.Checkpoint('Preenchendo Causas');
  
  VerificaClickPreencheGrid(GridCausas,i, 'Código', ValidaEventosDPCodCau);
  
  GridCausas.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTCausas.Name);
end;

procedure PreencheValidaVinculos(pathData);
var
DDTVinculos : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 2;
  
  DDTVinculos := CarregaDDT(pathData, 'Vínculos');
  
  LeDataPoolValidacoes(DDTVinculos.Name);
  
  BtnIncVin.Click();
  
  Log.Checkpoint('Preenchendo Vínculos');
  
  VerificaClickPreencheGrid(GridVinculos,i, 'Código', ValidaEventosDPCodVin);
  
  GridVinculos.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTVinculos.Name);
end;

procedure PreencheValidaProcessamentos();
var
DDTProcessamento : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 3;
  
  DDTProcessamentos := CarregaDDT(pathData, 'Processamentos');
  
  LeDataPoolValidacoes(DDTProcessamento.Name);
  
  BtnIncProc.Click();
  
  Log.Checkpoint('Preenchendo Processamentos');
  
  VerificaClickPreencheGrid(GridProcessamentos,i, 'Código', ValidaEventosDPCodProc);
  
  GridProcessamentos.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTProcessamento.Name);
end;

procedure PreencheValidaTurnos(pathData);
var
DDTTurnos : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 4;
  
  DDTTurnos := CarregaDDT(pathData, 'Turnos');
  
  LeDataPoolValidacoes(DDTTurnos.Name);
  
  BtnIncTur.Click();
  
  Log.Checkpoint('Preenchendo Turnos');
  
  VerificaClickPreencheGrid(GridTurnos,i, 'Código', ValidaEventosDPCodTurn);
  
  GridTurnos.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTTurnos.Name);
end;

procedure PreencheValidaCategorias(pathData);
var
DDTCategoria : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 5;
  
  DDTCategoria := CarregaDDT(pathData, 'Categorias');
  
  LeDataPoolValidacoes(DDTCategoria.Name);
  
  BtnIncCat.Click();
  
  Log.Checkpoint('Preenchendo Categorias');
  
  VerificaClickPreencheGrid(GridCategorias, i, 'Código', ValidaEventosDPCodCat);
  
  GridCategorias.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTCategoria.Name);
end;

procedure PreencheValidaConfiguracao(pathData);
var
DDTConfiguracao : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 6;
  
  DDTConfiguracao := CarregaDDT(pathData, 'Configuração Dirf-Rendimentos');
  
  LeDataPoolValidacoes(DDTConfiguracao.Name);
  
  BtnInc.Click();
  
  Log.Checkpoint('Preenchendo Configurações Dirf');
  
  VerificaInsere(CadDirfRendiEBCampo,CadDirfRendiDPCampo);
  VerificaInsere(CadDirfRendiEBLinha,CadDirfRendiDPLinha);
  VerificaInsere(CadDirfRendiEBFormula,CadDirfRendiDPFormula);
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTConfiguracao.Name);
end;

procedure PreencheIncidencias(pathData);
var
DDTIncidencia : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageTab.ActivePageIndex := 1;
  
  DDTCategoria := CarregaDDT(pathData, 'Incidências');
  
  LeDataPoolIncid(DDTIncidencia.Name);
  
  BtnIncIncide.Click();
  
  Log.Checkpoint('Preenchendo Categorias');
  
  VerificaClickPreencheGrid(GridIncidencias, i, 'Código', IncidEventosDPCod);
  
  GrideIncidencias.Click();
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTIncidencia.Name);
end;

procedure PreencheParametros(pathData);
var
DDTParamentro : OleVariant;
i : integer;
begin
i:= 0;

  CadFormPageValida.ActivePageIndex := 3;
  
  DDTParamentro := CarregaDDT(pathData, 'Parâmetros');
  
  LeDataPoolParam(DDTParamentro.Name);
  
  Log.Checkpoint('Preenchendo Configurações Dirf');
  
  VerificaInsere(CadDirfRendiEBCampo,CadDirfRendiDPCampo);
  VerificaInsere(CadDirfRendiEBLinha,CadDirfRendiDPLinha);
  VerificaInsere(CadDirfRendiEBFormula,CadDirfRendiDPFormula);
  
  if (Aliases.Folha.WaitWindow('#32770', 'Aviso', 1, 2000).Exists) then
  begin
    TelaAviso := Aliases.Folha.Window('#32770', 'Aviso', 1);
    
    BtnSim := TelaAviso.Window('Button', '&Sim', 1);
    BtnNao := TelaAviso.Window('Button', '&Não', 2);
    
    BtnNao.Click();
  end;
  DDT.CloseDriver(DDTConfiguracao.Name);
end;

procedure PreencheESocial(pathData);
begin


end;

procedure CadastraEvento(pathData);
begin

end;

procedure AlteraEvento(pathData);
begin

end;

procedure ExcluiEvento(pathData);
begin

end;
